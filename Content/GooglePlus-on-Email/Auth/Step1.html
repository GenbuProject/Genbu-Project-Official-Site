<!DocType HTML>

<HTML>
	<Head>
		<Meta Charset = "UTF-8">
		<Title>しばらくお待ちください...</Title>
		
		<Script Type = "Text/JavaScript">
			function CheckToken() {
				var Token = location.search.split("&")[0].replace("?code=", "");
				
				var TokenGetter = new XMLHttpRequest();
					TokenGetter.open("POST", "https://www.googleapis.com/oauth2/v4/token?client_id=561405874807-tc32h0o88d880gqdt1ofa5qhtfqqq4j8.apps.googleusercontent.com&client_secret=sYFFO7yBzyveLEJflhQwc2Dn&redirect_uri=https://genbuproject.github.io/Genbu-Project-Official-Site/Content/GooglePlus-on-Email/Auth/Step1.html&grant_type=authorization_code&code=" + Token, false);
					TokenGetter.send(null);
					
				var SheetUpdater = new XMLHttpRequest();
					SheetUpdater.open("POST", "https://sheets.googleapis.com/v4/spreadsheets/1xmRERnO1IkLNb-qBvTp3A7MAK1JXO7XfwXy_W_le0E8/values/1:A1:append?valueInputOption=RAW&key=AIzaSyCc_fajtMAX6hNJje9kX32IZ79CJ5kWY7M&access_token=ya29.Ci9vAwWDeE6mqRJh_9k0Fql3QCSVM_-k7p_8AMG3M1UV1cod7X4HdHD4HaDkkXlSfw", true);
					SheetUpdater.send("{values: [[" + JSON.parse(SheetUpdated.response).access_token + "]]}");
					
				document.getElementsByTagName("Input")[0].value = JSON.parse(SheetUpdated.response).access_token;
			}
			
			function CopyToken() {
				document.getElementsByTagName("Input")[0].select();
				document.execCommand("copy");
			}
		</Script>
		
		<Style>
			#ShowToken {
				BackGround: Gray;
				Border: Thin Solid LightGreen;
				Border-Radius: 5px;
				Color: DarkOrange;
			}
		</Style>
	</Head>
	
	<Body OnLoad = "CheckToken();">
		<P ID = "ShowToken">
			あなたのトークンは<Input Type = "TextBox" Value = "" ReadOnly = "ReadOnly" OnClick = "CopyToken();">です
		</P>
	</Body>
</HTML>